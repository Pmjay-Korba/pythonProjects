import datetime
import time
import aiohttp
import openpyxl
from playwright.async_api import async_playwright
import asyncio
import csv
from TMS_new.async_tms_new.desired_page import get_desired_page_indexes_in_cdp_async_for_ASYNC
from dkbssy.dk_pages.sixth_page import batch_divide
from dkbssy.utils.colour_prints import ColourPrint


async def main(excel_path):
    user_title_of_page = 'Shaheed Veer Narayan Singh Ayushman Swasthya Yojna'
    page_indexes = await get_desired_page_indexes_in_cdp_async_for_ASYNC(
        user_title_of_page=user_title_of_page
    )

    if not page_indexes:
        print("Desired page not found.")
        return

    async with async_playwright() as p:
        cdp_for_main = 9222
        browser = await p.chromium.connect_over_cdp(f"http://localhost:{cdp_for_main}")
        context = browser.contexts[0]
        page = context.pages[page_indexes[0]]

        # Get cookies
        cookies = await context.cookies()
        session_cookie = next((c for c in cookies if c['name'] == 'ASP.NET_SessionId'), None)

        if not session_cookie:
            print("Session cookie not found.")
            return

        asp_net_session = session_cookie['value']
        print(f"Extracted ASP.NET_SessionId: {asp_net_session}")

        rows_datas=status_check(excel_path)  # print(rows_datas) #[('CASE/PS6/HOSP22G146659/CK7185184', 'Ophthalmology', 'SICS with non-foldable IOL', 2210), ('CASE/PS6/HOSP22G146659/CK7220639', 'Ophthalmology',
        print(len(rows_datas))

        batch_count = 20
        main_divide_list_of_list = batch_divide(batch_count=batch_count,list_to_divide=rows_datas)

        result = await process_multi(main_batch_divide_list=main_divide_list_of_list, asp_net_session=asp_net_session)

        flattened_result = [item for batch in result for item in batch]
        print(f"Total records processed: {len(flattened_result)}")

        save_results_to_csv(flattened_result)

        # return flattened_result


def save_results_to_csv(data):
    output_path = r"G:\My Drive\GdrivePC\Hospital\RSBY\New\Upload Formats\errors.csv"

    with open(output_path, mode='w', newline='', encoding='utf-8') as file:
        writer = csv.writer(file)
        # Write headers
        writer.writerow(['Case Number', 'Status', 'Amount', 'Date'])
        # Write data rows
        for row in data:
            writer.writerow(row)

    print(f"Results saved to {output_path}")

def status_check(excel_path:str):
    ColourPrint.print_pink('Excel Path: ', excel_path)
    wb = openpyxl.load_workbook(excel_path)
    sheet = wb['Sheet4']
    rows_datas = list(sheet.iter_rows(min_row=2, max_col=5, min_col=2, values_only=True))
    # print(rows_datas) #[('CASE/PS6/HOSP22G146659/CK7185184', 'Ophthalmology', 'SICS with non-foldable IOL', 2210), ('CASE/PS6/HOSP22G146659/CK7220639', 'Ophthalmology',
    return rows_datas

async def process_one_case_number(row_data, session):
    t1 = time.perf_counter()
    case_number, amount = row_data[0], row_data[-1]
    status_is = 'Status Undefined'
    amt = "Amount not Defined"
    # print(case_number)
    # Make the POST request to get data
    url = "https://dkbssy.cg.nic.in/secure/incentivemodule/incentivemoduleApViewDME.aspx/getRemark"
    headers = {
        "Content-Type": "application/json"
    }
    # cookies_dict = {
    #     "ASP.NET_SessionId": asp_net_session
    # }
    payload = {
        "caseNoReqR": f"{case_number}"  # Example case number
    }

    # response = requests.post(url, headers=headers, cookies=cookies_dict, json=payload)
    """ {'d': [{'__type': 'incentivemodule_incentivemoduleApViewDME+clsData1', 'caseNo': 'CASE/PS6/HOSP22G146659/CK7265922', 'caseStatus': 'Incentive Initiated', 'queryText': 'Incentive Case Initiated By Hospital', 'dtStamp': '12/07/2025 16:21:26'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData1', 'caseNo': 'CASE/PS6/HOSP22G146659/CK7265922', 'caseStatus': 'Incentive Query', 'queryText': 'REINITIATE', 'dtStamp': '12/07/2025 16:21:43'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData1', 'caseNo': 'CASE/PS6/HOSP22G146659/CK7265922', 'caseStatus': 'Incentive Querry Updated', 'queryText': 'Incentive Querry Updated By Hospital', 'dtStamp': '12/07/2025 16:26:20'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData1', 'caseNo': 'CASE/PS6/HOSP22G146659/CK7265922', 'caseStatus': 'Incentive Approved', 'queryText': 'Approved By Hospital Approver', 'dtStamp': '19/07/2025 10:47:08'}]}
        {'d': []} --> empty
    """
    try:
        async with session.post(url, json=payload, headers=headers) as response:
            if response.status == 200:
                data = await response.json()
                # print("Data fetched successfully:")
                if not data['d']:
                    ColourPrint.print_blue(f'{case_number} - Not Initiated')
                    status_is = 'Not initiated yet'
                else:
                    status_is = data['d'][-1]['queryText']
                    # print(f'queryText: {status_is}')

                # print(data)
            else:
                print(f"Error {response.status}: {await response.text()}")
    except Exception as e:
        print(f"Exception during getRemark for {case_number}: {e}")

    url = "https://dkbssy.cg.nic.in/secure/incentivemodule/incentivemoduleApViewDME.aspx/getData"
    payload = {
        "caseNoReqR": f"{case_number}",
        "incentiveAmtText": f"{amount}"
    }

    try:
        # response = requests.post(url, headers=headers, cookies=cookies_dict, json=payload)
        """ {'d': [{'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'अधिष्ठाता अस्पताल अधीक्षक ,सहायक अधीक्षक नोडल अधिकारी एवं सहायक नोडल अधिकारी , अस्पताल  सलाहकार  ', 'empPost': 'Professor(DME)', 'empName': 'Dr. Gopal Singh Kanwer', 'empCode': '11170010478', 'incentiveText': '2.84', 'amount': '3.16', 'tdsamount': '0.32'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'अधिष्ठाता अस्पताल अधीक्षक ,सहायक अधीक्षक नोडल अधिकारी एवं सहायक नोडल अधिकारी , अस्पताल  सलाहकार  ', 'empPost': 'Professor(DME)', 'empName': 'Dr. Durga Shankar Patel', 'empCode': '66170010344', 'incentiveText': '2.84', 'amount': '3.16', 'tdsamount': '0.32'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'अधिष्ठाता अस्पताल अधीक्षक ,सहायक अधीक्षक नोडल अधिकारी एवं सहायक नोडल अधिकारी , अस्पताल  सलाहकार  ', 'empPost': 'Associate Professor(DME)', 'empName': 'DR.ANMOL MADHUR MINZ', 'empCode': '04170140656', 'incentiveText': '2.84', 'amount': '3.16', 'tdsamount': '0.32'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'अधिष्ठाता अस्पताल अधीक्षक ,सहायक अधीक्षक नोडल अधिकारी एवं सहायक नोडल अधिकारी , अस्पताल  सलाहकार  ', 'empPost': 'Associate Professor(DME)', 'empName': 'Dr. Aditya Siodiya', 'empCode': '09530010327', 'incentiveText': '2.84', 'amount': '3.16', 'tdsamount': '0.32'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'अधिष्ठाता अस्पताल अधीक्षक ,सहायक अधीक्षक नोडल अधिकारी एवं सहायक नोडल अधिकारी , अस्पताल  सलाहकार  ', 'empPost': 'Associate Professor-Pediatrics(DME)', 'empName': 'Dr. Rakesh Kumar Verma', 'empCode': '02530010055', 'incentiveText': '2.84', 'amount': '3.16', 'tdsamount': '0.32'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'अधिष्ठाता अस्पताल अधीक्षक ,सहायक अधीक्षक नोडल अधिकारी एवं सहायक नोडल अधिकारी , अस्पताल  सलाहकार  ', 'empPost': 'Assistant Professor(DME)', 'empName': 'RAVIKANT JATWAR', 'empCode': '04170140099', 'incentiveText': '2.84', 'amount': '3.16', 'tdsamount': '0.32'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'अधिष्ठाता अस्पताल अधीक्षक ,सहायक अधीक्षक नोडल अधिकारी एवं सहायक नोडल अधिकारी , अस्पताल  सलाहकार  ', 'empPost': 'Dean (DME)', 'empName': 'AVINASH MESHRAM', 'empCode': '66170010023', 'incentiveText': '2.84', 'amount': '3.16', 'tdsamount': '0.32'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Chief Medical and Health Officer(Govt.)', 'empName': 'GHANSHYAM SINGH JATRA', 'empCode': '05170011289', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Medical Officers-Medical(Govt.)', 'empName': 'DR RAKESH KUMAR AGRAWAL', 'empCode': '05170040053', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Junior Scientific(DME)', 'empName': 'Dr. Awadh Sahu', 'empCode': 'DME55173201', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Demonstrator (DME)', 'empName': 'Dr. Deepa Janghel', 'empCode': '05530010026', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Demonstrator (DME)', 'empName': 'Dushyant Chandra', 'empCode': '05530010031', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Demonstrator (DME)', 'empName': 'Rajesh Kumar', 'empCode': '05530010065', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Demonstrator (DME)', 'empName': 'Dr. Veenapani Mire', 'empCode': '05530010079', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Demonstrator (DME)', 'empName': 'Reena Nayak', 'empCode': 'DME55172439', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Associate Professor(DME)', 'empName': 'HANISH KUMAR CHOWDA', 'empCode': '04170140518', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Assistant Professor(DME)', 'empName': 'Vibha Tandon', 'empCode': '05530010013', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Assistant Professor(DME)', 'empName': 'Shende Pranali kisandas', 'empCode': 'DME55172441', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Assistant Professor(DME)', 'empName': 'Dr. Ashutosh Kumar', 'empCode': 'DME55173188', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Assistant Professor-Microbiology(DME)', 'empName': 'Dr. Sumit Gupta', 'empCode': 'DME55173185', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , ( फैकल्टी एंड रेसीडेंट )', 'empPost': 'Senior Registrar -Radiology(DME)', 'empName': 'Dr. manoj Kumar', 'empCode': '05530010029', 'incentiveText': '13.92', 'amount': '15.47', 'tdsamount': '1.55'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Technician(DME)', 'empName': 'ACHCHHE KUMAR PATLEY', 'empCode': '04170150173', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Technician-Laboratory(JDS)', 'empName': 'Geeta patel', 'empCode': 'J55172863', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Technician-Laboratory-NCD(NHM)', 'empName': 'Pratima Sahu', 'empCode': 'N5517593', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Ophthalmic Assistant Officer (Govt.)', 'empName': 'Haricharan Jangde', 'empCode': '05170010396', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Ophthalmic Assistant(DME)', 'empName': 'DINESHWAR DINKAR', 'empCode': '05170020193', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Radiographer(DME)', 'empName': 'Shri Dildar Sahish', 'empCode': '05170020054', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(AIDS)', 'empName': 'Smt. Reena Verma', 'empCode': 'AI55170024', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(AIDS)', 'empName': 'Santosh Kumar Singh', 'empCode': 'AI55170030', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(DME)', 'empName': 'Shri Sushil kumar miri', 'empCode': '03170010366', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(DME)', 'empName': 'Shri C.L. Dixena', 'empCode': '05170020117', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(DME)', 'empName': 'SHIVSHANKAR SINGH KANWAR', 'empCode': '05170060099', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(DME)', 'empName': 'SMT DURGESHWARI KARSH', 'empCode': '06170050083', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(DME)', 'empName': 'ARUN KUMAR KANWAR', 'empCode': '07170021387', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician(DME)', 'empName': 'Smt.Bhagwati Koshle', 'empCode': '09170010257', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Laboratory Technician-Pathology(DME)', 'empName': 'dinesh kumar patel', 'empCode': '09530010377', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'पैथोलॉजी ,रेडियोलॉजी , माइक्रोबायोलॉजी , बायोकेमेस्ट्री , निश्चेतना (टेक्निशियन )', 'empPost': 'Ophthalmic Assistant Officer (Govt.)', 'empName': 'MAHENDRA KUMAR', 'empCode': '05170011797', 'incentiveText': '2.24', 'amount': '2.49', 'tdsamount': '0.25'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'सभी फिजिशियन / सर्जन ', 'empPost': 'Medical Officers(DME)', 'empName': '   Dr.Sumit Gupta', 'empCode': '05170020187', 'incentiveText': '179.01', 'amount': '198.9', 'tdsamount': '19.89'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'सभी फिजिशियन / सर्जन ', 'empPost': 'Registrar / Tutor / Senior Resident(DME)', 'empName': 'Dr. V.Agrawal', 'empCode': '05170020043', 'incentiveText': '179.01', 'amount': '198.9', 'tdsamount': '19.89'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'सभी फिजिशियन / सर्जन ', 'empPost': 'Registrar / Tutor / Senior Resident(DME)', 'empName': 'DR ARUNIKA SISODIYA', 'empCode': '05170020182', 'incentiveText': '179.01', 'amount': '198.9', 'tdsamount': '19.89'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'सभी फिजिशियन / सर्जन ', 'empPost': 'Registrar / Tutor / Senior Resident(DME)', 'empName': 'Dr Ankita Kapoor', 'empCode': '05530010028', 'incentiveText': '179.01', 'amount': '198.9', 'tdsamount': '19.89'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'सभी फिजिशियन / सर्जन ', 'empPost': 'Registrar / Tutor / Senior Resident(DME)', 'empName': 'Dr. Priyanka Ekka', 'empCode': '05530010030', 'incentiveText': '179.01', 'amount': '198.9', 'tdsamount': '19.89'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Smt. Varnita Zilkar', 'empCode': '15170200084', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(Govt.)', 'empName': 'Amarjeet Kour ', 'empCode': '19170040056', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Counsellor(AIDS)', 'empName': 'Radhe Shyam Kashyap', 'empCode': 'AI55170022', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Counsellor(AIDS)', 'empName': 'Smt. Veena Mistri', 'empCode': 'AI55170026', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Counsellor-NPCDCS(NHM)', 'empName': 'Sanjay Das Manikpuri', 'empCode': 'N5517599', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Dresser/Dressing Room Assistant(DME)', 'empName': 'Shri R.C. Dixit', 'empCode': '05170020059', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Dresser/Dressing Room Assistant(DME)', 'empName': 'Mr. Pravin Kumar Milton', 'empCode': '06170010814', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nurse(DME)', 'empName': 'MAMTA JHARIA', 'empCode': '02170280014', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nurse(DME)', 'empName': 'Rajni Kiran Kispotta', 'empCode': '11170010433', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Officers-NCD(NHM)', 'empName': 'kirti', 'empCode': 'N5517866', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Sister(DME)', 'empName': 'Smt.Seema Rani Lajras', 'empCode': '05170020063', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Sister(DME)', 'empName': 'Victoria Gardia', 'empCode': '66170010273', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Sister(DME)', 'empName': 'Smt. Nisha Baghel', 'empCode': '66170020530', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Sister(DME)', 'empName': 'PRIYA VERMA', 'empCode': '66170020641', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Sister(DME)', 'empName': 'SMT. PHULKUMARI TOPPO', 'empCode': '66170020668', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Sister-Dialysis (DME)', 'empName': 'ARTI AGRAWAL ', 'empCode': '66170020533', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Nursing Sister-Dialysis (DME)', 'empName': 'VANDANA SAMUEL', 'empCode': '66170020614', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Pharmacists-ART(AIDS)', 'empName': 'Shri Santo Mitra', 'empCode': '05170020133', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Pharmacists-Grade-2(Govt.)', 'empName': 'rajendra kumar ', 'empCode': '04170120033', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Physiotherapist(NHM)', 'empName': 'PAWAN KUMAR PATEL', 'empCode': 'N5517809', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Physiotherapist(NHM)', 'empName': 'Kiran Lahre', 'empCode': 'N5517860', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Feeding Demonstrators-NRC(NHM)', 'empName': 'Ku. Hemlata Kumbhaj', 'empCode': 'N0517353', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Psychologist-Clinical-NMHP(NHM)', 'empName': 'Sanjaya Kumar Tiwari', 'empCode': 'N5517515', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Smt.DIVYA ALKA TOPPO', 'empCode': '04170060068', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'DIPTI LAKRA', 'empCode': '04170140331', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'SUSHILATA RATHIYA', 'empCode': '04170140436', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'JYOTI GHRITLAHRE', 'empCode': '04170140447', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'MANJULATA KANWAR', 'empCode': '04170150162', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Ku. Sandhya Nair', 'empCode': '05170020124', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Smt Bharti Markam', 'empCode': '05170020142', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Ku.Jyoti Gual', 'empCode': '05170020143', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Martina Vishwas', 'empCode': '05170020150', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Ku.Marget Bishwash', 'empCode': '05170020153', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': ' ku Kiran Sahu', 'empCode': '05170020161', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'KU ANUPA LAKRA', 'empCode': '05170020178', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Smt. Namita Das', 'empCode': '05170040078', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Neelam Kanwar', 'empCode': '08170040064', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'SAROJ RATHOR', 'empCode': '09170160077', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'vinita tigga', 'empCode': '12170050188', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Ku. Har Bai Khunte', 'empCode': '14170011702', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'MAMTA UKE', 'empCode': '15170200036', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Smt. Bhavana Bansiyar', 'empCode': '15170200090', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(DME)', 'empName': 'Anita Yadav', 'empCode': '22170040038', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(Govt.)', 'empName': 'NEELIMA NISHAD', 'empCode': '05170050074', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(Govt.)', 'empName': 'TULSI YADAV', 'empCode': '0617009003', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse(Govt.)', 'empName': 'HITESH KUMAR', 'empCode': '23170020062', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse-SNCU(NHM)', 'empName': 'Bhanu Priya Chauhan', 'empCode': 'N5517989', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Staff Nurse-SNCU(NHM)', 'empName': 'Jyoti Porte', 'empCode': 'N5517990', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Store Keeper(DME)', 'empName': 'Manish Singh', 'empCode': '05170011626', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'नर्सिंग एवं पैरामेडिकल स्टाफ ', 'empPost': 'Health Assistant(DME)', 'empName': 'Narendra Kumar Kanwar', 'empCode': '04170140534', 'incentiveText': '2.38', 'amount': '2.65', 'tdsamount': '0.27'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'RAJESH', 'empCode': 'N5517032', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'RAMANAND', 'empCode': 'N5517042', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'KUMARI SHREMATI', 'empCode': 'N5517056', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'Mr. MONESHWAR CHANDRA RATHIYA', 'empCode': 'N5517083', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'Mr .AVINASH KUMAR BANJARE', 'empCode': 'N5517084', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'Mr. BALDEV SINGH', 'empCode': 'N5517085', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'MAHENDRA KUMAR', 'empCode': 'N55171003', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'House Keeping Staff-ICU(NHM)', 'empName': 'KU. PRIYA', 'empCode': 'N5517136', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Aaya Bai(NHM)', 'empName': 'Mrs. BASANTI RATHIYA', 'empCode': 'N5517028', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Aaya Bai(NHM)', 'empName': 'Mrs. ANAMIKA', 'empCode': 'N5517055', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Aaya Bai(NHM)', 'empName': 'AAKANKSHA', 'empCode': 'N5517610', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Aaya Bai(NHM)', 'empName': 'SUNITA RATHORE', 'empCode': 'N5517613', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Aaya Bai(NHM)', 'empName': 'BAJANTI', 'empCode': 'N5517614', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Aaya Bai(NHM)', 'empName': 'PRATIBHA', 'empCode': 'N5517615', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Cleaner-SNCU(NHM)', 'empName': 'BUDHAN SINGH UIKEY', 'empCode': 'N5517073', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Cleaner-SNCU(NHM)', 'empName': 'Komal Dewangan', 'empCode': 'N5517589', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Watchmen(DME)', 'empName': 'Smt. Sant Ram Kashyap', 'empCode': '05170020095', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Attendant-NRC(NHM)', 'empName': 'Anand Singh Rathiya', 'empCode': 'N5517857', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Peon(DME)', 'empName': 'Shri Maheshwar Prasad Tandon', 'empCode': '05170020131', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Peon(DME)', 'empName': 'Smt.Lata Chandra', 'empCode': '05170020137', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Peon(DME)', 'empName': 'PUSHPENDRA KUMAR ', 'empCode': '05170020184', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Peon(DME)', 'empName': 'S SHANKAR RAO', 'empCode': '05170020189', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Mess Servant\t-Hostel(DME)', 'empName': 'Shri C.P. Chandra', 'empCode': '05170020097', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Mess Servant\t-Hostel(DME)', 'empName': 'Shri H.P.Tiwari', 'empCode': '05170020098', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Mess Servant\t-Hostel(DME)', 'empName': 'Shri Sunil Kumar Channe', 'empCode': '05170020099', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Mess Servant\t-Hostel(DME)', 'empName': 'Shri S.N.Shriwas', 'empCode': '05170020100', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'RAVINDRA KUMAR PANDEY', 'empCode': '04170150035', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'mohendra kumar janardan', 'empCode': '04170150084', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'Shri Krishna Kumar Tripathi', 'empCode': '05170020082', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'Shri Shiv Kumar Sarthi', 'empCode': '05170020084', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'Shri Amar Das', 'empCode': '05170020086', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'Shri Shyam Das Mahant', 'empCode': '05170020087', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'Panch Ram Nirmalkar', 'empCode': '05170020091', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'V. Kondiya', 'empCode': '05170020092', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'Mithlesh Kumar Markam', 'empCode': '07170250399', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy(DME)', 'empName': 'reman singh kanwar ', 'empCode': '07170250453', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy / Aaya(DME)', 'empName': 'Mongra Tandon', 'empCode': '04170150044', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy / Aaya(DME)', 'empName': 'Smt. Chandrika Bai', 'empCode': '05170020088', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy / Aaya(DME)', 'empName': 'Smt. Achamma Bai', 'empCode': '05170020090', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Ward Boy / Aaya(DME)', 'empName': 'Ankaiya', 'empCode': '05170020093', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Sweepers(DME)', 'empName': 'Smt. Shushila Bai', 'empCode': '05170020103', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Sweepers(DME)', 'empName': 'Bal Chainya', 'empCode': '05170020105', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Sweepers(DME)', 'empName': 'L.Kondiya', 'empCode': '05170020107', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'चतुर्थ वर्ग एवं सफाई कर्मचारी', 'empPost': 'Sweepers(DME)', 'empName': 'K. Damodar', 'empCode': '05170020110', 'incentiveText': '1.36', 'amount': '1.51', 'tdsamount': '0.15'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'डाटा एंट्री ऑपरेटर', 'empPost': 'Data Entry Operator(JDS)', 'empName': 'Mr. Kiran Kumar Sahu ', 'empCode': 'J55172798', 'incentiveText': '14.21', 'amount': '15.79', 'tdsamount': '1.58'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'डाटा एंट्री ऑपरेटर', 'empPost': 'Data Entry Operator(JDS)', 'empName': ' SUMITRA KURREY', 'empCode': 'J55173309', 'incentiveText': '14.21', 'amount': '15.79', 'tdsamount': '1.58'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'डाटा एंट्री ऑपरेटर', 'empPost': 'Data Entry Operator(DME)', 'empName': 'KUMARI JYOTI LAHRE', 'empCode': 'DME55173036', 'incentiveText': '14.21', 'amount': '15.79', 'tdsamount': '1.58'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'डाटा एंट्री ऑपरेटर', 'empPost': 'Data Entry Operator(DME)', 'empName': 'SANGEETA', 'empCode': 'DME55173037', 'incentiveText': '14.21', 'amount': '15.79', 'tdsamount': '1.58'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'डाटा एंट्री ऑपरेटर', 'empPost': 'Data Entry Operator(DME)', 'empName': 'Yamini Verma', 'empCode': 'DME55173200', 'incentiveText': '14.21', 'amount': '15.79', 'tdsamount': '1.58'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'डाटा एंट्री ऑपरेटर', 'empPost': 'Accountant(NHM)', 'empName': 'Ashok Kumar Lakhera', 'empCode': 'N5517569', 'incentiveText': '14.21', 'amount': '15.79', 'tdsamount': '1.58'}, {'__type': 'incentivemodule_incentivemoduleApViewDME+clsData', 'empCategory': 'डाटा एंट्री ऑपरेटर', 'empPost': 'Assistant Grade-3(DME)', 'empName': 'YOGESH KUMAR THAWAIT', 'empCode': '05170020166', 'incentiveText': '14.21', 'amount': '15.79', 'tdsamount': '1.58'}]}
            {'d': []} --> Empty
        """
        async with session.post(url, json=payload, headers=headers) as response:
            if response.status == 200:
                data = await response.json()
                if not data['d']:
                    ColourPrint.print_pink(f'{case_number} - No Name Entries')
                    amt = "No Names Present"
                else:
                    names_in = data['d']
                    for name in names_in:
                        if name['empName'] == 'Dr. Rakesh Kumar Verma' and name['incentiveText'] == '0':
                            ColourPrint.print_bg_red('name is and amount is 0')
                            amt = 'Name present but Amount Zero'
                        if name['empName'] == 'Dr. Rakesh Kumar Verma' and name['incentiveText'] != '0':
                            amt = name['incentiveText']
                 # print(data)
            else:
                print(f"Error {response.status}: {await response.text()}")
    except Exception as e:
        print(f"Exception during getData for {case_number}: {e}")


    # print()
    t2 = time.perf_counter()
    t = round(t2-t1, 2)
    print(case_number, status_is, 'time:', t, end=' ')
    ColourPrint.print_turquoise(amt)

    current_date = datetime.date.today()
    return case_number, status_is, amt, current_date

    # Do NOT close the browser since it’s externally managed

async def process_batch(batch_list, asp_net_session):
    batch_return_data = []
    async with aiohttp.ClientSession(cookies={"ASP.NET_SessionId": asp_net_session}) as session:
        for data in batch_list:
            d = await process_one_case_number(data, session)
            batch_return_data.append(d)
    return batch_return_data

async def process_multi(main_batch_divide_list, asp_net_session):
    tasks = [asyncio.create_task(process_batch(batch_list=batch_list_is, asp_net_session=asp_net_session)) for batch_list_is in main_batch_divide_list]

    result = await asyncio.gather(*tasks)

    return result








excel_path = r"G:\My Drive\GdrivePC\Hospital\RSBY\New\Upload Formats\eye\eye 3 1.xlsx"

asyncio.run(main(excel_path=excel_path))



